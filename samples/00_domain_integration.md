# Интеграция доменов AliExpress

Этот документ описывает связи между различными доменами базы данных для системы работы с AliExpress.

## Схема связей между доменами

+------------------------+
|        Marketplace     |
|    (03_marketplace)    |
+------------------------+
           |
           | marketplace_id
           |
           v
+------------------------+      +------------------------+
|       Accounts         |<-----| Registration           |
|    (04_accounts)       |      | (05_registration)      |
+------------------------+      +------------------------+
           |                              |
           | user_id                      | user_id
           |                              |
           v                              v
+------------------------+      +------------------------+
|        Users           |----->|      Contacts          |
|   (01_users_domain)    |      |  (02_contacts_domain)  |
+------------------------+      +------------------------+

## Доступные домены

1. **Домен пользователей** (`01_users_domain.md`)
   - Содержит информацию о пользователях системы
   - Основная таблица: `Users`

2. **Домен контактов** (`02_contacts_domain.md`)
   - Содержит информацию о контактных данных пользователей
   - Основные таблицы:
     - `ContactTypes` (типы контактных данных)
     - `UserContacts` (контактные данные пользователей)

3. **Домен маркетплейса** (`03_marketplace_domain.md`)
   - Содержит информацию о маркетплейсе AliExpress
   - Основная таблица: `Marketplace`

4. **Домен аккаунтов** (`04_accounts_domain.md`)
   - Содержит информацию об аккаунтах пользователей на AliExpress
   - Основные таблицы: 
     - `Accounts` (информация об аккаунтах)
     - `AccountActions` (действия с аккаунтами)
     - `AccountSecurity` (настройки безопасности)

5. **Домен регистрации** (`05_registration_domain.md`)
   - Содержит информацию о процессе регистрации новых аккаунтов
   - Основные таблицы:
     - `RegistrationAccounts` (информация о регистрации)
     - `RegistrationLogs` (логи процесса регистрации)

## Ключевые связи между доменами

1. **Marketplace → Accounts**
   - `Accounts.marketplace_id` → `Marketplace.marketplace_id`
   - Каждый аккаунт принадлежит конкретному маркетплейсу

2. **Marketplace → Registration**
   - `RegistrationAccounts.marketplace_id` → `Marketplace.marketplace_id`
   - Процесс регистрации выполняется для конкретного маркетплейса

3. **Registration → Accounts**
   - После успешной регистрации данные переносятся в таблицу аккаунтов
   - Связь через общие поля: email, телефон, логин

4. **Accounts/Registration → Users**
   - `Accounts.user_id` → `Users.user_id`
   - `RegistrationAccounts.user_id` → `Users.user_id`
   - Аккаунты и регистрации связаны с пользователями системы

5. **Users → Contacts**
   - `UserContacts.user_id` → `Users.user_id`
   - Контактные данные привязаны к пользователям

## Рекомендации по дальнейшей оптимизации

1. **Унификация именования**
   - Использовать единый префикс (например, `ae_`) для всех таблиц, связанных с AliExpress
   - Обеспечить единый стиль именования полей и таблиц

2. **Оптимизация индексов**
   - Создать составные индексы для часто используемых соединений
   - Особенно важно для полей `user_id`, `marketplace_id` и `account_id`

3. **Журналирование изменений**
   - Добавить таблицы для отслеживания истории изменений в ключевых доменах
   - Использовать триггеры для автоматического заполнения этих таблиц

4. **Подготовка к расширению**
   - Обеспечить возможность добавления новых маркетплейсов (Taobao, JD.com и др.)
   - Предусмотреть возможность добавления новых доменов (заказы, логистика, платежи) 
